SSASD - (SaveSectionsAsSeparateDocuments) отдельная программа (приложение), предназначенная для разделения fb2 файлов на части.
Программа в текущей версии 6.2. существенно улучшена и доработана.

Данное описание приложения SSASD датировано 04-06-2022.
_____________________________________________________________________________
Автор программы - Sclex.
Идеи, предварительное тестирование, описание работы - TaKir
_____________________________________________________________________________

Файл программы представлен в 3 вариациях:

SaveSectionsAsSeparateDocuments.hta
SaveSectionsAsSeparateDocuments_MSXML4.hta
SaveSectionsAsSeparateDocuments_MSXML6.hta

Для работы программы нужен любой из этих файлов + служебный html-файл (SSASD - Show Wrong Titles.html) для отображения диалогов.

В вашей системе могут корректно работать все три версии программы, а может - только какая-то одна.
_____________________________________________________________________________

Как пользоваться:

Файлы .hta и .html должны лежать в одной папке.

- Запускаем приложение.
- Кнопкой "Обзор" выбираем исходный файл для разделения на части, согласно имеющимся в файле заголовкам разделов.
- Жмем кнопку "Найти и показать заголовки разделов".
В окошке ниже будут отображены все имеющиеся в выбранном файле заголовки (разделы).

- Эти разделы можно выбрать в окошке вручную (с нажатыми клавишами CTRL, SHIFT или CTRL+SHIFT мышкой выбрать несколько произвольных разделов) или выбрать автоматическое разделение по разделам верхнего уровня.

- Под окошком с заголовками выбираем один из 4 вариантов оформления ваших заголовков.

- Нажимаем по необходимости одну из кнопок: "Сохранить выбранные разделы..." или "Сохранить как отдельные документы..."

* Будет произведено разделение исходного документы на отдельные файлы.

Варианты оформления заголовков исходных разделов в 2 строки:

Автор (первая строка заголовка)
Название (вторая строка заголовка)

либо наоборот:

Название (первая строка заголовка)
Автор (вторая строка заголовка)

либо

Название (в 1 или единственной строке заголовков)
Название (во 2 или единственной строке заголовков)

При выборе соответствующего варианта, автор(ы) и название, указанные в заголовках разделов исходного файла, будут автоматически прописаны в дескрипшены вновь созданных файлов в соответствующих полях.

При необходимости оставить в новых файлах всех авторов из дескрипшена исходного документа, нужно выбрать соответствующий вариант в опциях внизу.

Опционально галочкой включается пункт сохранения эпиграфов или "нулевых" секций без заголовков (относящихся ко всей книге в целом) из исходного файла во всех вновь создаваемых файлах.
По умолчанию данная опция выключена.

В режиме "Сохранить как отдельные документы все разделы верхнего уровня" автоматически создается необходимое кол-во файлов по количеству разделов верхнего уровня.
Авторы и названия сохраняются согласно выбранному в опциях варианту.

* В случае наличия в исходном файле одновременно двух- и одноабзацных заголовков и выборе в опциях вариантов Автор+Название или Название+Автор, программа сообщит об ошибке, выведет список одноабзацных заголовков и новые файлы созданы не будут.
В таком случае необходимо в исходном файле (или его копии) сделать перечисленные заголовки двухабзацными, чтобы сработала выбранная в настройках опция.
_____________________________________________________________________________

Особенности и функции:

- Разделение исходного файла на части происходит с сохранением любой возможной вложенности разделов и всего форматирования.

- В дескрипшене автоматически всем новым файлам прописывается новое название и автор(ы) (если была выбрана соответствующая опция).
- В дескрипшене автоматически всем новым файлам случайным образом присваивается новый уникальный ID fb2 файла.
- В дескрипшене автоматически всем новым файлам назначается текущая дата.
- Все остальные поля дескрипшена полностью наследуются из исходного документа.

- Наименование файлов осуществляется латиницей, согласно названию конкретного нового документа в заголовке body.

- В начале имен файлов используется номер в стиле 0001_Nazvanie_fayla.fb2 для понимания порядка последовательности файлов, полученных из исходного документа.

- Готовые файлы получаются валидными согласно fb2 схеме.

- Готовые файлы сохраняются в папку с исходным fb2 документом.

- При повторном сохранении этих же разделов, к названиям файлов в конце добавляется номер 0001, 0002... для избежания полных дублей названий файлов в папке.

- Настройки программы нигде не сохраняются, при каждом новом использовании опции разделения файла на части выбираются согласно оформлению конкретного исходного файла.
_____________________________________________________________________________

Ссылки на скачивание (версия 6.2):

https://github.com/sensboston/fictionbookeditor/raw/master/files/Utilities/Save%20Sections%20As%20Separate%20Documents/SSASD%20-%20Show%20Wrong%20Titles.html

https://raw.githubusercontent.com/sensboston/fictionbookeditor/master/files/Utilities/Save%20Sections%20As%20Separate%20Documents/SaveSectionsAsSeparateDocuments.hta

https://raw.githubusercontent.com/sensboston/fictionbookeditor/master/files/Utilities/Save%20Sections%20As%20Separate%20Documents/SaveSectionsAsSeparateDocuments_MSXML4.hta

https://raw.githubusercontent.com/sensboston/fictionbookeditor/master/files/Utilities/Save%20Sections%20As%20Separate%20Documents/SaveSectionsAsSeparateDocuments_MSXML6.hta
